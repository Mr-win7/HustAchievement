var posData = [
	// chihuo
	// 西校区
	// {
	// 	name: '百惠园',
	// 	longitude: {
	// 		from: ,
	// 		to: 
	// 	},
	// 	latitude: {
	// 		from: ,
	// 		to: 
	// 	}
	// },
	{
		name: '西一食堂',
		longitude: {
			from: 114.412277,
			to: 114.412659
		},
		latitude: {
			from: 30.519875,
			to: 30.52003
		}
	},
	{
		name: '西二食堂',
		longitude: {
			from: 114.411783,
			to: 114.412277
		},
		latitude: {
			from: 30.519735,
			to: 30.519906
		}
	},
	// {
	// 	name: '百品屋',
	// 	longitude: {
	// 		from: ,
	// 		to: 
	// 	},
	// 	latitude: {
	// 		from: ,
	// 		to: 
	// 	}
	// },
	// {
	// 	name: '枫林湾',
	// 	longitude: {
	// 		from: ,
	// 		to: 
	// 	},
	// 	latitude: {
	// 		from: ,
	// 		to: 
	// 	}
	// },
	{
		name: '百景园',
		longitude: {
			from: 114.414608,
			to: 114.414914
		},
		latitude: {
			from: 30.521714,
			to: 30.521913
		}
	},
	//中校区
	{
		name: '喻园食堂',
		longitude: {
			from: 114.414371,
			to: 114.415149
		},
		latitude: {
			from: 30.515886,
			to: 30.516362 
		}
	},
	// {
	// 	name: '集锦园',
	// 	longitude: {
	// 		from: ,
	// 		to: 
	// 	},
	// 	latitude: {
	// 		from: ,
	// 		to: 
	// 	}
	// },
	{
		name: 'CBD广场',
		longitude: {
			from: 114.421408,
			to: 114.422275
		},
		latitude: {
			from: 30.521975,
			to: 30.522636
		}
	},
	{
		name: '集贤楼',
		longitude: {
			from: 114.416544,
			to: 114.417416
		},
		latitude: {
			from: 30.514168,
			to: 30.514820
		}
	},
	{
		name: '紫荆园',
		longitude: {
			from: 114.421525,
			to: 114.421844
		},
		latitude: {
			from: 30.522301,
			to: 30.522426
		}
	},
	{
		name: '东一食堂',
		longitude: {
			from: 114.425747,
			to: 114.426205
		},
		latitude: {
			from: 30.516608,
			to: 30.516737
		}
	},
	{
		name: '东三食堂',
		longitude: {
			from: 114.426623,
			to: 114.426991
		},
		latitude: {
			from: 30.51632,
			to: 30.516445	
		}
	},
	// {
	// 	name: '清真食堂',
	// 	longitude: {
	// 		from: ,
	// 		to: 
	// 	},
	// 	latitude: {
	// 		from: ,
	// 		to: 
	// 	}
	// },
	//东校区
	{
		name: '韵苑食堂',
		longitude: {
			from: 114.437928,
			to: 114.438957
		},
		latitude: {
			from: 30.519832,
			to: 30.520563
		}
	},
	{
		name: '学一食堂',
		longitude: {
			from: 114.438391,
			to: 114.438943
		},
		latitude: {
			from: 30.516954,
			to: 30.517114
		}
	},
	{
		name: '学二食堂',
		longitude: {
			from: 114.438144,
			to: 114.438521
		},
		latitude: {
			from: 30.517612,
			to: 30.517732
		}
	},
	{
		name: '百盛园',
		longitude: {
			from: 114.437955,
			to: 114.438265
		},
		latitude: {
			from: 30.516157,
			to: 30.516254
		}
	},
	{
		name: '东园食堂',
		longitude: {
			from: 114.442285,
			to: 114.442954
		},
		latitude: {
			from: 30.519148,
			to: 30.519509
		}
	},
	// {
	// 	name: '东篱餐厅',
	// 	longitude: {
	// 		from: ,
	// 		to: 
	// 	},
	// 	latitude: {
	// 		from: ,
	// 		to: 
	// 	}
	// },
	// luchi
	// 东校区
	{
		name: '工程实训中心',
		longitude: {
			from: 114.436626,
			to: 114.437533
		},
		latitude: {
			from: 30.512379,
			to: 30.513581
		}
	},
	{
		name: '启明学院',
		longitude: {
			from: 114.429701,
			to: 114.431664
		},
		latitude: {
			from: 30.508358,
			to: 30.509597
		}
	},
	{
		name: '东十二教学楼',
		longitude: {
			from: 114.433092,
			to: 114.434715
		},
		latitude: {
			from: 30.511750,
			to: 30.512462, 
		}
	},
	{
		name: '爱因斯坦广场',
		longitude: {
			from: 114.435297,
			to: 114.436016
		},
		latitude: {
			from: 30.513642,
			to: 30.514481 
		}
	},
	{
		name: '韵苑体育馆',
		longitude: {
			from: 114.434157,
			to: 114.435441
		},
		latitude: {
			from: 30.512336,
			to: 30.513667
		}
	},
	{
		name: '东九教学楼',
		longitude: {
			from: 114.425485,
			to: 114.428519
		},
		latitude: {
			from: 30.512017,
			to: 30.514968
		}
	},
	{
		name: '喻园小区',
		longitude: {
			from: 114.420773,
			to: 114.427058
		},
		latitude: {
			from: 30.514708,
			to: 30.518300
		}
	},
	// 中校区
	{
		name: '主校医院',
		longitude: {
			from: 114.413825,
			to: 114.415588
		},
		latitude: {
			from: 30.516881,
			to: 30.517900, 
		}
	},
	{
		name: '管理学院',
		longitude: {
			from: 114.415001,
			to: 114.417601
		},
		latitude: {
			from: 30.514632,
			to: 30.516026
		}
	},
	{
		name: '大学生活动中心',
		longitude: {
			from: 114.413311,
			to: 114.414880
		},
		latitude: {
			from: 30.513939,
			to: 30.515030
		}
	},
	{
		name: '光谷体育馆',
		longitude: {
			from: 114.416957,
			to: 114.419600
		},
		latitude: {
			from: 30.507044,
			to: 30.509152
		}
	},
	{
		name: '醉晚亭',
		longitude: {
			from: 114.416831,
			to: 114.418137
		},
		latitude: {
			from: 30.509700,
			to: 30.510987
		}
	},
	// 西校区
	{
		name: '西十二楼',
		longitude: {
			from: 114.405946,
			to: 114.408607
		},
		latitude: {
			from: 30.508444,
			to: 30.509623
		}
	},
	{
		name: '西五楼',
		longitude: {
			from: 114.409210,
			to: 114.410567
		},
		latitude: {
			from: 30.510133,
			to: 30.511053
		}
	},
	{
		name: '图书馆',
		longitude: {
			from: 114.410519,
			to: 114.412691
		},
		latitude: {
			from: 30.511293,
			to: 30.513627
		}
	},
	{
		name: '校史馆',
		longitude: {
			from: 114.412875,
			to: 114.414581
		},
		latitude: {
			from: 30.511085,
			to: 30.512208
		}
	},
	{
		name: '西边操场',
		longitude: {
			from: 114.405208,
			to: 114.407959
		},
		latitude: {
			from: 30.511630,
			to: 30.513442
		}
	},
	{
		name: '科技楼',
		longitude: {
			from: 114.411639,
			to: 114.412814
		},
		latitude: {
			from: 30.513341,
			to: 30.514284
		}
	},
	{
		name: '青年园',
		longitude: {
			from: 114.407690,
			to: 114.410613
		},
		latitude: {
			from: 30.511130,
			to: 30.514633
		}
	},
	{
		name: '艺术团',
		longitude: {
			from: 114.404761,
			to: 114.405834
		},
		latitude: {
			from: 30.513230,
			to: 30.513796
		}
	},
	// liulang
	{
		name: '爬一次喻家山',
		longitude: {
			from: 114.404627,
			to: 114.428338
		},
		latitude: {
			from: 30.517749, 
			to: 30.525913
		}
	},
	{
		name: '去光谷逛吃逛吃',
		longitude: {
			from: 114.398392,
			to: 114.409496
		},
		latitude: {
			from: 30.500785,
			to: 30.508189
		}
	},
	{
		name: '森林公园夜跑',
		longitude: {
			from: 114.436082,
			to: 114.436082
		},
		latitude: {
			from: 30.531236,
			to: 30.531236
		}
	},
	{
		name: '去武大视察一次',
		longitude: {
			from: 114.353143,
			to: 114.380156
		},
		latitude: {
			from: 30.527729,
			to: 30.548118
		}
	},
	{
		name: '去一次汉口江滩',
		longitude: {
			from: 114.296689,
			to: 114.336429
		},
		latitude: {
			from: 30.578443,
			to: 30.637158
		}
	},
	// xueba
	{
		name: '听一次图书馆闭馆铃声',
		longitude: {
			from: 114.410519,
			to: 114.412691
		},
		latitude: {
			from: 30.511293,
			to: 30.513627
		}
	},
	{
		name: '参加西五楼的人文讲座',
		longitude: {
			from: 114.409210,
			to: 114.410567
		},
		latitude: {
			from: 30.510133,
			to: 30.511053
		}
	},
	{
		name: '参观湖北省博物馆',
		longitude: {
			from: 114.360698,
			to: 114.368404
		},
		latitude: {
			from: 30.557990,
			to: 30.564681
		}
	},
	/*
	{
		name: '',
		longitude: {
			from: ,
			to: 
		},
		latitude: {
			from: ,
			to: 
		}
	},
	*/
];

function checkPostion(pos){
	var lat = pos.latitude;
	var lng = pos.longitude;
	var result = [];
	for(var i = 0; i < posData.length; i++){
		var p = posData[i];
		if(lat >= p.latitude.from && lat <= p.latitude.to && lng >= p.longitude.from && lng <= p.longitude.to){
			result.push(p.name);
		}
	}
	return result;
}

function getLoction(reqname){
	if(navigator.geolocation){
		navigator.geolocation.getCurrentPosition(function (position){
			var pos = {
				latitude: position.coords.latitude,
				longitude: position.coords.longitude
			};
			var name = checkPostion(pos);
			if(name.indexOf(reqname) >= 0){
				$.ajax({
					type: 'GET',
					url: '/user/user/achieve',
					data: {
						achievementName: reqname
					}
				}).done(function(){
					$('#' + reqname).removeClass('place-notactive')
									.addClass('place-active');
				}).fail(errHandler);
			} else if (name.length == 0) {
				warn('定位失败！');
			}
		}, errHandler);
	}
}

function errHandler(error){
	switch(error.code) {
		case error.PERMISSION_DENIED:
			warn("User denied the request for Geolocation.");
			break;
		case error.POSITION_UNAVAILABLE:
			warn("Location information is unavailable.");
			break;
		case error.TIMEOUT:
			warn("The request to get user location timed out.");
			break;
		case error.UNKNOWN_ERROR:
			warn("An unknown error occurred.");
			break;
	}
}
/*
function showPosition(position){ 
    var latlon = position.coords.latitude+','+position.coords.longitude; 
    
    var url = "http://api.map.baidu.com/geocoder/v2/?ak=C93b5178d7a8ebdb830b9b557abce78b&callback=renderReverse&location="+latlon+"&output=json&pois=0"; 
    $.ajax({  
        type: "GET",  
        dataType: "jsonp",  
        url: url, 
        beforeSend: function(){ 
            $("#baidu_geo").html('正在定位...'); 
        }, 
        success: function (json) {  
            if(json.status==0){ 
                $("#baidu_geo").html(json.result); 
            } 
        }, 
        error: function (XMLHttpRequest, textStatus, errorThrown) {  
            $("#baidu_geo").html(latlon+"地址位置获取失败");  
        } 
    }); 
};
*/

$(function(){
	$('.place').click(function(e){
		var target = $(e.target);
		if (!target.hasClass('library')) {
			var id = target.attr('id');
			getLoction(id);
		}
	});
});

function warn(text){
    return alert(text);
}
